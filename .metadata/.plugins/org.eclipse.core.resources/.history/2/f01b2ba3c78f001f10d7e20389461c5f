/*
 * Doruk_Helper_Functions.h
 *
 *  Created on: Oct 21, 2024
 *      Author: Doruk Tan Atila
 */

#ifndef INC_DORUK_HELPER_FUNCTIONS_H_
#define INC_DORUK_HELPER_FUNCTIONS_H_


#include <stdarg.h>
#include <stdio.h>
#include <string.h>
/*
 * Functions to setup serial comms to Teraterm
 * Call teraterm_init in the beginning with huart used for serail comms
 *
 */

UART_HandleTypeDef *SerialComms_huart;

void TT_init(UART_HandleTypeDef *huart){
	SerialComms_huart = huart;
}
void TT_print_line(const char *format, ...){
    char buffer[256];   // Buffer to hold the formatted string
    va_list args;

    // Initialize the variable argument list
    va_start(args, format);
    vsnprintf(buffer, sizeof(buffer) - 3, format, args);  // Format the string (reserving space for \r\n)
    va_end(args);

    // Append \r\n at the end of the formatted string
    strcat(buffer, "\r\n");

    // Transmit the string via UART
    HAL_UART_Transmit(SerialComms_huart, (uint8_t*)buffer, strlen(buffer), HAL_MAX_DELAY);
}

void TT_print_line_reset(const char *format, ...) {
    char buffer[256];   // Buffer to hold the formatted string
    va_list args;

    // Initialize the buffer with the ANSI escape sequence to reset the cursor
    strcpy(buffer, "\033[H");  // \033[H moves the cursor to the top-left of the terminal

    // Initialize the variable argument list
    va_start(args, format);
    vsnprintf(buffer + strlen(buffer), sizeof(buffer) - strlen(buffer) - 3, format, args);  // Format the string (reserving space for \r\n)
    va_end(args);

    // Append \r\n at the end of the formatted string
    strcat(buffer, "\r\n");

    // Transmit the string via UART
    HAL_UART_Transmit(SerialComms_huart, (uint8_t*)buffer, strlen(buffer), HAL_MAX_DELAY);
}



#endif /* INC_DORUK_HELPER_FUNCTIONS_H_ */
